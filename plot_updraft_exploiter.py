""" Script to export matplotlib plots from training to tikz """

import gym
import torch

from parameters import params_environment, params_triangle_soaring, params_updraft_finder
import train_updraft_finder
import run_episode

device = torch.device("cuda:0" if torch.cuda.is_available() else "cpu")
env = gym.make('glider3D-v0', agent='updraft_finder')

ppo = train_updraft_finder.PPO()
ppo.model.actor.load_state_dict(torch.load(
   "updraft_finder_actor_final_16-February-2022_20-25.pt", map_location=torch.device('cpu')))

_params_agent = params_updraft_finder.AgentParameters()

start = 27
iterations = 1
for plot_number in range(start, start+iterations):
    print("Running iteration number {}!".format(plot_number))
    run_episode.main(env, ppo, plot_number, _params_agent, validation_mask=True)