""" Script to export matplotlib plots from training to tikz """

import gym
import torch

from subtasks.updraft_exploiter import params_updraft_exploiter
import train_updraft_exploiter
import run_episode

device = torch.device("cuda:0" if torch.cuda.is_available() else "cpu")
env = env = gym.make('glider3D-v0', agent='updraft_exploiter_uninformed')

ppo = train_updraft_exploiter.PPO()
ppo.model.actor.load_state_dict(torch.load(
   "updraft_exploiter_uninformed_actor_final_17-November-2021_14-22.pt", map_location=torch.device('cpu')))
ppo.model.critic.load_state_dict(torch.load(
   "updraft_exploiter_uninformed_critic_final_17-November-2021_14-22.pt", map_location=torch.device('cpu')))

# set seed to fix updraft distribution and trajectory
#env.seed(42)
#np.random.seed(42)

_params_agent = params_updraft_exploiter.params_agent()

iterations = 10
for plot_number in range(0, iterations):
    print("Running iteration number {}!".format(plot_number))
    run_episode.main(env, ppo, plot_number, _params_agent, validation_mask=True)